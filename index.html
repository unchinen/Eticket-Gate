<html>
  <head>
    <html lang="ja">
    <meta charset="utf-8">
   <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <!-- CSS 埋め込み -->
    <style>
       @media screen and (max-width: 480px) {
        * {
          margin: 0px;
          padding: 0px;
          height: 100%;
          box-sizing: border-box;
         padding: 0.5%;
        }

        body {
          width: 100%; /* リキッド */
          height: 100%;
          max-width: 100%; /* 幅の上限 */
          min-width: 100%; /* 幅の下限 */
          margin: 0px auto;
          overflow: hidden; /* スクロールバー隠し */
        }

        header { /*Eticket Gate*/
          font-size : 150%;
          height: 5%;
          width: 100%; /* リキッド ヘッダー*/
          box-sizing: border-box;
          padding: 0;
          background: #333;
          color: white;
          text-align: center;
        }
        
        #button1 {
          background-color: silver;
          width: 0%;
          height: 100%;
          float: left;
          color: white;
          font-size : 0%; 
          text-align: center;
        }

        nav {
          width: 100%; /* リキッド ナビ */
          float: left;
          height: 50%;
          background-color: white;
          border :  1px solid;
          border-color: #696969;
        }

        #chart1_box {
          width: 100%;
          height: 70%;
        }
        
        section { /*itemの親 こいつ+canvas=100%*/
          width: 100%; /* リキッド セクション */
          height: 50%;
          /*margin-left:auto; 意味なさげ
          margin-right:auto;*/
          float: left;
        }

        .item1 {
          width: 100%; /* リキッド item1 */
          height: 30%;
          background-color: #c0c0c0;
        }

        .item1_cube1 {
          width: 50%;
          height: 100%;
          border :  1px solid;
          border-color: #696969;
          float: left;
        }
        
        #string1 { /*感染リスク*/
          font-size : 100%; 
          width: 100%;
          height: 20%;
          text-align: center;
        }

        #danger {
          font-size : 300%; 
          width: 100%;
          height: 30%;
          text-align: center;
        }
        
        .item1_cube2 {
          width: 100%;
          height: 100%;
          border :  1px solid;
          border-color: #696969;
        }
        
        #string2 { /*入場者数*/
          font-size : 100%; 
          width: 100%;
          height: 20%;
          text-align: center;
        }
        
        #visitor {
          font-size : 300%; 
          width: 100%;
          height: 30%;
          text-align: center;
        }

        .item2 {
          width: 100%; /* リキッド item2 */
          height: 30%;
          background-color: #d3d3d3;
        }
        
         #total_visitor {
          font-size : 150%; 
          width: 100%;
          height: 50%;
          text-align: center;
          border :  1px solid;
          border-color: #696969;
        }
        
        #round_visitor {
          font-size : 150%; 
          width: 100%;
          height: 50%;
          text-align: center;
          border :  1px solid;
          border-color: #696969;
        }

        .item3 {
          width: 100%; /* リキッド item3 */
          height: 30%;
          background-color: #dcdcdc;
        }

        #view_today {
          font-size : 150%; 
          width: 100%;
          height: 34%;
          text-align: center;
        }
      }
      
      @media screen and (min-width: 480px) {
        * {
          margin: 0px;
          padding: 0px;
          height: 100%;
          box-sizing: border-box;
         padding: 0.5%;
        }

        body {
          width: 100%; /* リキッド */
          height: 100%;
          max-width: 100%; /* 幅の上限 */
          min-width: 100%; /* 幅の下限 */
          margin: 0px auto;
          overflow: hidden; /* スクロールバー隠し */
        }

        header { /*Eticket Gate*/
          font-size : 100%;
          height: 10%;
          width: 100%; /* リキッド ヘッダー*/
          box-sizing: border-box;
          padding: 0;
          background: #333;
          color: white;
          text-align: center;
        }
        
        #button1 {
          background-color: silver;
          width: 0%;
          height: 100%;
          float: left;
          color: white;
          font-size : 0%; 
          text-align: center;
        }

        nav {
          width: 50%; /* リキッド ナビ */
          float: left;
          height: 90%;
          background-color: white;
          border :  1px solid;
          border-color: #696969;
        }

        #chart1_box {
          width: 100%;
          height: 70%;
        }
        
        section { /*itemの親 こいつ+canvas=100%*/
          width: 50%; /* リキッド セクション */
          height: 100%;
          /*margin-left:auto; 意味なさげ
          margin-right:auto;*/
          float: left;
        }

        .item1 {
          width: 100%; /* リキッド item1 */
          height: 30%;
          background-color: #c0c0c0;
        }

        .item1_cube1 {
          width: 50%;
          height: 100%;
          border :  1px solid;
          border-color: #696969;
          float: left;
        }
        
        #string1 { /*感染リスク*/
          font-size : 100%; 
          width: 100%;
          height: 20%;
          text-align: center;
        }

        #danger {
          font-size : 300%; 
          width: 100%;
          height: 0%;
          text-align: center;
        }
        
        .item1_cube2 {
          width: 50%;
          height: 100%;
          border :  1px solid;
          border-color: #696969;
          float: left;
        }
        
        #string2 { /*入場者数*/
          font-size : 100%; 
          width: 100%;
          height: 20%;
          text-align: center;
        }
        
        #visitor {
          font-size : 300%; 
          width: 100%;
          height: 0%;
          text-align: center;
          float: left;
        }

        .item2 {
          width: 100%; /* リキッド item2 */
          height: 30%;
          background-color: #d3d3d3;
        }
        
         #total_visitor {
          font-size : 120%; 
          width: 100%;
          height: 50%;
          text-align: center;
          border :  1px solid;
          border-color: #696969;
        }
        
        #round_visitor {
          font-size : 120%; 
          width: 100%;
          height: 50%;
          text-align: center;
          border :  1px solid;
          border-color: #696969;
        }

        .item3 {
          width: 100%; /* リキッド item3 */
          height: 30%;
          background-color: #dcdcdc;
        }

        #view_today {
          font-size : 150%; 
          width: 100%;
          height: 34%;
          text-align: center;
        }
      }
      
      @media screen and (min-width: 900px) {
        * {
          margin: 0px;
          padding: 0px;
          width: 100%;
          height: 100%;
          font-size:100%;
          box-sizing: border-box;
          padding: 0.5%;
        }

        body {
          width: 100%; /* リキッド */
          height: 100%;
          max-width: 100%; /* 幅の上限 */
          min-width: 1200px; /* 幅の下限 */
          margin: 0px auto;
          overflow: hidden; /* スクロールバー隠し */
        }

        header{ /*Eticket Gate*/
          font-size : 300%;
          height: 15%;
          width: 100%; /* リキッド ヘッダー*/
          box-sizing: border-box;
          padding: 1%;
          background: #333;
          color: white;
          text-align: center;
        }

        #button1 {
            background-color: transparent;
            width: 0%;
            height: 0%;
            float: left;
            color: white;
            font-size : 150%; 
            text-align: center;
          }

        nav {
          width: 50%; /* リキッド ナビ */
          float: left;
          height: 100%;
          background-color: white;
          border :  1px solid;
          border-color: #696969;
        }

        #chart1_box {
          width: 100%;
          height: 50%;
        }

        section { /*itemの親 こいつ+canvas=100%*/
          width: 50%; /* リキッド セクション */
          height: 100%;
          /*margin-left:auto; 意味なさげ
          margin-right:auto;*/
          float: left;
        }

        .item1 {
          width: 100%; /* リキッド item1 */
          height: 33%;
          background-color: #c0c0c0;
          float: left;
        }

        .item1_cube1 {
          width: 50%;
          height: 100%;
          border :  1px solid;
          border-color: #696969;
          float: left;
        }

        #string1 { /*感染リスク*/
          font-size : 250%; 
          width: 100%;
          height: 20%;
          text-align: center;
        }

        #danger {
          font-size : 550%; 
          width: 100%;
          height: 30%;
          text-align: center;
        }

        .item1_cube2 {
            width: 50%;
            height: 100%;
            border :  1px solid;
            border-color: #696969;
            float: left;
          }

        #visitor {
          font-size : 550%; 
          width: 100%;
          height: 30%;
          text-align: center;
        }

        #string2 { /*入場者数*/
            font-size : 250%; 
            width: 100%;
            height: 20%;
            text-align: center;
          }

        .item2 {
          width: 100%; /* リキッド item2 */
          height: 33%;
          background-color: #d3d3d3;
          float: left;
        }

        #total_visitor {
            font-size : 250%; 
            width: 100%;
            height: 50%;
            text-align: center;
            border :  1px solid;
            border-color: #696969;
          }

         #round_visitor {
            font-size : 250%; 
            width: 100%;
            height: 50%;
            text-align: center;
            border :  1px solid;
            border-color: #696969;
          }

        .item3 {
          width: 100%; /* リキッド item3 */
          height: 100%;
          background-color: #dcdcdc;
        }

        #view_today {
          font-size : 250%; 
          width: 100%;
          height: 34%;
          text-align: center;
        } 
      }
      
     
   
      </style>
    </head>
    <body>
      <title>Eticket Gate graph</title>
      <header> 
        <button id="button1" type="button" onclick="history.back()"></button>
        Eticket Gate
      </header>
      <nav>
        <div id="chart1_box" style="width:100%">
          <canvas id="chart1"></canvas>
          </div>
        </nav>
      <section>
        <div class="item1">
          <div class="item1_cube1">
          <div id="string1">感染リスク</div>
          <div id="danger"></div>
            </div>
          <div class="item1_cube2">
            <div id="string2">入場者数</div>
            <div id="visitor"></div>
            </div>
        </div>
        <div class="item2">
           <div id="total_visitor"></div>
          <div id="round_visitor"></div>
          <div id="infection_data"></div>
        </div>
        <div class="item3">
          <div id="view_today"></div>
        </div>
      </section>
      </body>
            <!-- 色んな所に使うかもしれない変数-->
    <script>
        var gv = [['8時', 27], ['9時', 26], ['10時', 31], ['11時', 25], ['12時', 30], ['13時', 22], ['14時', 27], ['15時', 26], ['16時', 42], ['17時', 33], ['18時', 21], ['19時', 10], ['20時', 7], ['21時', 4], ['22時', 0], ['23時', 0]]; /*時間帯と入場者数の配列　glaph_valiable*/
      var total = for_total(); /*総入場者数*/
      function for_total(){
          var j = 0; 
          for (let i = 0; i < 10; i++){
             j += gv[i][1];
          }
          return j;
        }      
      document.getElementById("total_visitor").innerHTML = "今日の総入場者数 : " + total + "人";
        var visitor = gv[15][1]; /*入場者数　APIお待ちしています*/
        var round = (total / 16);
        document.getElementById("visitor").innerHTML = visitor + "人";
        document.getElementById("round_visitor").innerHTML = "１時間ごとの平均 : " + round + "人";
      </script>
           <!--   jQuery・bootstrapライブラリ読み込み -->
      <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
      <!--  独自ライブラリ読み込み -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
      <!-- view_todayを定義 -->
      <script type="text/javascript">
        document.getElementById("view_today").innerHTML = getToday();
        function getToday() {
          var now = new Date();
          var year = now.getFullYear();
          var mon = now.getMonth()+1; //１を足すこと
          var day = now.getDate();
          var you = now.getDay(); //曜日(0～6=日～土)
          //曜日の選択肢
          var youbi = new Array("日","月","火","水","木","金","土");
          //出力用
          var s = "現在 : " + year + "年" + mon + "月" + day + "日 (" + youbi[you] + ")";
          return s;
        }
      </script>
      <!-- chart1を定義-->
      <script>
        var ctx = document.getElementById("chart1");
        ctx.style.border = "1px solid";
        var w = $('#chart1_box').width();
	      var h = $('#chart1_box').height();
	      $('#chart1').attr('width', w);
	      $('#chart1').attr('height', h);
        /*canvas.width = chart1_box.clientWidth;　使ったらバグった
        canvas.height = char1_box.clientHeight;*/
        var myLineChart = new Chart(ctx, {
          // グラフの種類：折れ線グラフを指定
          type: 'line',
          data: {
            // x軸の各メモリ
            labels: [gv[0][0], gv[1][0], gv[2][0], gv[3][0], gv[4][0], gv[5][0], gv[6][0], gv[7][0], gv[8][0], gv[9][0], gv[10][0], gv[11][0], gv[12][0], gv[13][0], gv[14][0], gv[15][0]],
            datasets: [
              {
                label: '現在の人場者数',
                data: [gv[0][1], gv[1][1], gv[2][1], gv[3][1], gv[4][1], gv[5][1], gv[6][1], gv[7][1], gv[8][1], gv[9][1], gv[10][1], gv[11][1], gv[12][1], gv[13][1], gv[14][1], gv[15][1]],//ここをラズパイとリンクさせたい
                borderColor: "#ec4343",
                backgroundColor: "#00000000",
                lineTension:0
              },
             ],
          },
          scales: {
            yAxes: [{
              ticks: {
                suggestedMax: 50,//教室用
                suggestedMin: 0,
                stepSize: 10,  // 縦メモリのステップ数
                callback: function(value, index, values){
                  return  value +  '人'  // 各メモリのステップごとの表記（valueは各ステップの値）
                }
              }
            }]
          }, 
       });
        </script>
        <!-- dangerを定義-->
      <script> 
        var rating = 0 //人数と１０万人当たり感染者数のＡＰＩを使って危険度を設定（ＡＰＩ準備出来次第式を式に書き換え）
        var high = 1; //リスク低の基準値（相場がわからない・・・）
        var low = 2; //リスク高の基準値（相場がわからない・・・）
        var ratingtext;
        if(rating < low){
          ratingtext = "低";
          document.getElementById("danger").style.color = "blue";
        }
        else if(rating < high){
          ratingtext = "中";
          document.getElementById("danger").style.color = "yellow";
        }
        else{
          ratingtext = "高";
          document.getElementById("danger").style.color = "red";
        }
        document.getElementById("danger").innerHTML = ratingtext;
      </script>
    <!-- スマホを画面を変えたときグラフを再描画-->
      <script>
         window.addEventListener("orientationchange", function() {
            location.reload();
        });
        </script>
    <!-- 総感染者をwebからもってくるAPI だがcorsにはじかれて死亡中-->
    <script>/*
         fetch("https://opendata.corona.go.jp/api/Covid19JapanAll?dataName=%E6%B2%96%E7%B8%84%E7%9C%8C",{
           method: 'GET',
           mode: 'cors'
         })
        .then(function (responce){
          return responce.json();
         })
        .then(function (json_root){
          // ここにURLのデータを取得した時の処理
          var infection_json = json_root.itemList[0];
          document.getElementById("infection_data").lastElementChild.textContent = json.date;
          var infection_date = infection_json.date;
          var infection_name_jp = infection_json.name_jp;
          var infection_npatients = infection_json.npatients;
          var infection_string = infection_name_jp + " " + infection_date + "時点の総感染者数 : " +  infection_npatients + "人";
          }); */
     </script> 
  </html>
